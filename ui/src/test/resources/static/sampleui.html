<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>OpenClaw+ ‚Äî Project Command Center (Example)</title>
    <style>
        :root{
          --bg:#0b0f17; --panel:#0f1624; --panel2:#0c1220; --card:#121c2e;
          --text:#e7eefc; --muted:#9ab0d1; --faint:#6f86ab; --line:#21314d;
          --good:#24d18f; --warn:#ffcc66; --bad:#ff5a7a; --accent:#7aa2ff; --accent2:#b58cff;
          --shadow:0 14px 40px rgba(0,0,0,.35); --radius:16px;
          --mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
          --sans:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
        }
        *{box-sizing:border-box}
        html,body{height:100%}
        body{
          margin:0; font-family:var(--sans); color:var(--text);
          background:
            radial-gradient(1200px 800px at 20% -10%, rgba(122,162,255,.18), transparent 60%),
            radial-gradient(900px 700px at 110% 20%, rgba(181,140,255,.14), transparent 55%),
            radial-gradient(700px 600px at 20% 110%, rgba(36,209,143,.10), transparent 55%),
            var(--bg);
          overflow:hidden;
        }
        .app{height:100%; display:grid; grid-template-columns:280px 1fr 420px; gap:14px; padding:14px;}
        .pane{
          min-height:0; border:1px solid rgba(255,255,255,.06);
          border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden;
          background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
        }
        .left{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01)), var(--panel2);}
        .mid{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01)), var(--panel);}
        .right{background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01)), var(--panel2);}

        .bar{
          display:flex; align-items:center; justify-content:space-between; gap:10px;
          padding:14px; border-bottom:1px solid rgba(255,255,255,.06);
          background:rgba(0,0,0,.12); backdrop-filter: blur(10px);
        }
        .brand{display:flex; align-items:center; gap:10px; font-weight:800;}
        .logo{width:34px; height:34px; border-radius:12px; border:1px solid rgba(255,255,255,.18);
          background:
            radial-gradient(12px 12px at 30% 30%, rgba(255,255,255,.45), transparent 50%),
            linear-gradient(135deg, rgba(122,162,255,.95), rgba(181,140,255,.85));
          box-shadow:0 10px 30px rgba(122,162,255,.18);
        }
        .pill{
          display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px;
          background:rgba(122,162,255,.10); border:1px solid rgba(122,162,255,.25);
          font-size:12px; white-space:nowrap;
        }
        .pill.good{background:rgba(36,209,143,.10); border-color:rgba(36,209,143,.22)}
        .pill.warn{background:rgba(255,204,102,.10); border-color:rgba(255,204,102,.22)}
        .pill.bad{background:rgba(255,90,122,.10); border-color:rgba(255,90,122,.22)}
        .btn{
          cursor:pointer; user-select:none; padding:8px 10px; border-radius:12px;
          border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.04);
          color:var(--text); font-size:12px; display:inline-flex; align-items:center; gap:8px;
        }
        .btn:hover{background:rgba(255,255,255,.06)}
        .btn.primary{
          background:linear-gradient(135deg, rgba(122,162,255,.26), rgba(181,140,255,.18));
          border:1px solid rgba(122,162,255,.32);
        }
        .search{
          flex:1; display:flex; align-items:center; gap:8px; padding:8px 10px;
          border-radius:12px; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08);
          min-width:140px;
        }
        .search input{width:100%; border:0; outline:none; background:transparent; color:var(--text); font-size:13px;}
        .kbd{font-family:var(--mono); font-size:11px; padding:2px 6px; border-radius:8px;
          background:rgba(0,0,0,.20); border:1px solid rgba(255,255,255,.10); color:rgba(231,238,252,.85);
        }

        /* Left nav */
        .leftBody{height:calc(100% - 58px); overflow:auto; padding:10px; display:flex; flex-direction:column; gap:10px;}
        .sectionTitle{margin:8px 8px 2px; font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:.8px;}
        .navItem{
          display:flex; align-items:center; justify-content:space-between; gap:10px;
          padding:10px; border-radius:14px; cursor:pointer;
          border:1px solid rgba(255,255,255,.06); background:rgba(255,255,255,.02);
        }
        .navItem:hover{background:rgba(255,255,255,.04)}
        .navItem.active{
          background:linear-gradient(135deg, rgba(122,162,255,.18), rgba(181,140,255,.10));
          border-color:rgba(122,162,255,.28);
        }
        .navLeft{display:flex; align-items:center; gap:10px; min-width:0;}
        .icon{
          width:34px; height:34px; border-radius:12px; display:grid; place-items:center;
          background:rgba(122,162,255,.10); border:1px solid rgba(122,162,255,.20); font-size:16px;
        }
        .navText{display:flex; flex-direction:column; gap:2px; min-width:0;}
        .navText .t{font-weight:750; font-size:13px}
        .navText .d{font-size:12px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
        .badge{
          font-family:var(--mono); font-size:11px; padding:3px 8px; border-radius:999px;
          border:1px solid rgba(255,255,255,.10); background:rgba(0,0,0,.18); color:rgba(231,238,252,.9);
        }
        .filters{
          border:1px solid rgba(255,255,255,.07); border-radius:14px; padding:10px;
          background:rgba(255,255,255,.02); display:flex; flex-direction:column; gap:10px;
        }
        label{font-size:11px; color:var(--muted)}
        select,input[type="date"]{
          width:100%; padding:9px 10px; border-radius:12px; border:1px solid rgba(255,255,255,.10);
          background:rgba(255,255,255,.03); color:var(--text); outline:none; font-size:12px;
        }
        .row{display:flex; gap:10px;}
        .row>*{flex:1}
        .hint{font-size:12px; color:var(--muted); line-height:1.35}

        /* Middle content */
        .midBody{height:calc(100% - 58px); overflow:auto; padding:14px; display:flex; flex-direction:column; gap:14px;}
        .card{
          border:1px solid rgba(255,255,255,.07);
          background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
          border-radius:var(--radius); overflow:hidden;
        }
        .cardHeader{
          padding:12px; border-bottom:1px solid rgba(255,255,255,.06);
          background:rgba(0,0,0,.12);
          display:flex; align-items:center; justify-content:space-between; gap:10px;
        }
        .cardHeader .h{font-weight:800; font-size:13px; display:flex; gap:8px; align-items:center;}
        .sub{font-size:12px; color:var(--muted); margin-top:2px}
        .cardBody{padding:12px;}
        .grid2{display:grid; grid-template-columns:1.1fr .9fr; gap:12px;}
        .stream{
          border:1px solid rgba(255,255,255,.07); border-radius:14px;
          background:rgba(0,0,0,.10); overflow:hidden;
        }
        .streamTop{
          padding:10px; border-bottom:1px solid rgba(255,255,255,.06); display:flex; align-items:center; justify-content:space-between;
          background:rgba(255,255,255,.02);
        }
        .streamList{max-height:430px; overflow:auto; padding:10px; display:flex; flex-direction:column; gap:10px;}
        .streamItem{
          border:1px solid rgba(255,255,255,.07); border-radius:14px; padding:10px;
          background:rgba(255,255,255,.02); cursor:pointer;
        }
        .streamItem:hover{background:rgba(255,255,255,.03)}
        .streamItem.active{border-color:rgba(122,162,255,.40); background:rgba(122,162,255,.08)}
        .metaRow{display:flex; align-items:center; justify-content:space-between; gap:10px;}
        .metaRow .when{font-family:var(--mono); font-size:11px; color:rgba(231,238,252,.85)}
        .metaRow .src{font-size:11px; color:var(--faint)}
        .title{font-weight:800; font-size:13px; margin:6px 0 4px}
        .desc{font-size:12px; color:var(--muted); line-height:1.35}
        .chips{display:flex; gap:6px; flex-wrap:wrap; margin-top:8px}
        .chip{
          font-size:11px; padding:4px 8px; border-radius:999px;
          background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); color:rgba(231,238,252,.92);
        }
        .chip.thread{background:rgba(122,162,255,.10); border-color:rgba(122,162,255,.22)}
        .chip.risk{background:rgba(255,90,122,.10); border-color:rgba(255,90,122,.22)}
        .chip.decision{background:rgba(255,204,102,.10); border-color:rgba(255,204,102,.22)}
        .chip.action{background:rgba(36,209,143,.10); border-color:rgba(36,209,143,.22)}
        .threadPane{
          border:1px solid rgba(255,255,255,.07); border-radius:14px; overflow:hidden; background:rgba(0,0,0,.10);
        }
        .threadTabs{display:flex; gap:8px; padding:10px; border-bottom:1px solid rgba(255,255,255,.06); background:rgba(255,255,255,.02); flex-wrap:wrap;}
        .tab{padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.10); background:rgba(0,0,0,.14); font-size:12px; cursor:pointer;}
        .tab.active{border-color:rgba(122,162,255,.35); background:rgba(122,162,255,.10)}
        .threadBody{padding:10px; max-height:430px; overflow:auto;}
        .kv{display:grid; grid-template-columns: 130px 1fr; gap:10px; padding:10px; border:1px solid rgba(255,255,255,.07); border-radius:14px; background:rgba(255,255,255,.02); margin-bottom:10px;}
        .k{font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:.7px}
        .v{font-size:12px; color:rgba(231,238,252,.92); line-height:1.35}
        .list{display:flex; flex-direction:column; gap:8px;}
        .listItem{
          border:1px solid rgba(255,255,255,.07); border-radius:14px; padding:10px; background:rgba(255,255,255,.02);
          display:flex; justify-content:space-between; gap:10px; align-items:flex-start;
        }
        .liTitle{font-weight:800; font-size:12px}
        .liDesc{font-size:12px; color:var(--muted); margin-top:4px; line-height:1.3}
        .liRight{display:flex; flex-direction:column; gap:6px; align-items:flex-end}
        .prio{font-family:var(--mono); font-size:11px; padding:3px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.10); background:rgba(0,0,0,.18)}
        .prio.p1{border-color:rgba(255,90,122,.35)}
        .prio.p2{border-color:rgba(255,204,102,.35)}
        .prio.p3{border-color:rgba(36,209,143,.35)}

        /* Objectives board */
        .objGrid{display:grid; grid-template-columns:repeat(3,1fr); gap:10px;}
        .objCard{border:1px solid rgba(255,255,255,.07); border-radius:14px; padding:10px; background:rgba(255,255,255,.02);}
        .objCard .o{font-weight:850; font-size:13px}
        .objCard .kr{font-size:12px; color:var(--muted); margin-top:6px; line-height:1.35}
        .cov{display:flex; align-items:center; gap:10px; margin-top:10px;}
        .barOuter{flex:1; height:10px; border-radius:999px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.06); overflow:hidden;}
        .barInner{height:100%; width:60%; background:linear-gradient(90deg, rgba(36,209,143,.70), rgba(122,162,255,.55));}
        .pct{font-family:var(--mono); font-size:11px; color:var(--muted); width:44px; text-align:right;}

        /* Reconcile */
        .reconGrid{display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px;}
        .miniCol{border:1px solid rgba(255,255,255,.07); border-radius:14px; background:rgba(0,0,0,.10); overflow:hidden;}
        .miniHead{padding:10px; border-bottom:1px solid rgba(255,255,255,.06); background:rgba(255,255,255,.02); display:flex; justify-content:space-between; align-items:center;}
        .miniBody{padding:10px; max-height:300px; overflow:auto; display:flex; flex-direction:column; gap:8px;}
        .rowCard{border:1px solid rgba(255,255,255,.07); border-radius:14px; padding:10px; background:rgba(255,255,255,.02);}
        .rowCard .rTitle{font-weight:800; font-size:12px}
        .rowCard .rMeta{font-family:var(--mono); font-size:11px; color:rgba(231,238,252,.85); margin-top:6px}
        .conf{font-family:var(--mono); font-size:11px; padding:3px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.10); background:rgba(0,0,0,.18)}
        .conf.low{border-color:rgba(255,90,122,.35)}
        .conf.med{border-color:rgba(255,204,102,.35)}
        .conf.high{border-color:rgba(36,209,143,.35)}

        /* Right inspector */
        .rightBody{height:calc(100% - 58px); overflow:auto; padding:14px; display:flex; flex-direction:column; gap:14px;}
        .insBlock{padding:12px}
        .mono{font-family:var(--mono)}
        textarea{
          width:100%; min-height:88px; resize:vertical; padding:10px; border-radius:12px;
          border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.03); color:var(--text); outline:none; font-size:12px;
        }
        .log{
          font-family:var(--mono); font-size:11px; line-height:1.35; padding:10px; border-radius:14px;
          border:1px solid rgba(255,255,255,.08); background:rgba(0,0,0,.20);
          max-height:220px; overflow:auto; white-space:pre-wrap;
        }
        .toast{
          position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
          padding:10px 12px; border-radius:14px; background:rgba(10,14,22,.84);
          border:1px solid rgba(255,255,255,.10); box-shadow:var(--shadow);
          display:none; gap:10px; align-items:center; color:rgba(231,238,252,.95);
          font-size:12px; max-width:min(920px, calc(100vw - 28px)); backdrop-filter: blur(10px);
        }
        .toast.show{display:flex}
        .ticon{width:26px; height:26px; border-radius:10px; display:grid; place-items:center; background:rgba(36,209,143,.12); border:1px solid rgba(36,209,143,.25);}

        /* Responsive */
        @media (max-width: 1240px){
          body{overflow:auto}
          .app{grid-template-columns:280px 1fr; grid-template-rows:auto auto; height:auto}
          .right{grid-column:1 / -1}
        }
        @media (max-width: 860px){
          .app{grid-template-columns:1fr;}
          .left{display:none}
        }
    </style>
</head>
<body>
<div class="app">
    <!-- LEFT -->
    <aside class="pane left">
        <div class="bar">
            <div class="brand"><div class="logo"></div><div>OpenClaw<span style="opacity:.8;">+</span></div></div>
            <span class="pill">Workspace <b id="wsName">KYC Modernization</b></span>
        </div>

        <div class="leftBody">
            <div class="filters">
                <div class="row">
                    <div>
                        <label>From</label>
                        <input type="date" id="fromDate"/>
                    </div>
                    <div>
                        <label>To</label>
                        <input type="date" id="toDate"/>
                    </div>
                </div>
                <div class="row">
                    <div>
                        <label>Owner</label>
                        <select id="ownerFilter">
                            <option>All</option>
                            <option>Eng Pod A</option>
                            <option>Architect</option>
                            <option>PMO</option>
                            <option>SRE</option>
                        </select>
                    </div>
                    <div>
                        <label>Sprint</label>
                        <select id="sprintFilter">
                            <option>Sprint 12</option>
                            <option selected>Sprint 13</option>
                            <option>Sprint 14</option>
                        </select>
                    </div>
                </div>
                <div class="hint">Your loop: upload ‚Üí agent threads ‚Üí objectives by sprint ‚Üí tickets/status ‚Üí reconcile PM plan.</div>
            </div>

            <div class="sectionTitle">Command Views</div>
            <div class="navItem active" data-view="today">
                <div class="navLeft">
                    <div class="icon">üß≠</div>
                    <div class="navText"><div class="t">Today</div><div class="d">What needs attention</div></div>
                </div>
                <span class="badge" id="todayBadge">7</span>
            </div>
            <div class="navItem" data-view="inbox">
                <div class="navLeft">
                    <div class="icon">üì•</div>
                    <div class="navText"><div class="t">Inbox</div><div class="d">Uploads + date streams</div></div>
                </div>
                <span class="badge" id="inboxBadge">12</span>
            </div>
            <div class="navItem" data-view="threads">
                <div class="navLeft">
                    <div class="icon">üßµ</div>
                    <div class="navText"><div class="t">Threads</div><div class="d">Agent-curated topics</div></div>
                </div>
                <span class="badge" id="threadsBadge">5</span>
            </div>
            <div class="navItem" data-view="objectives">
                <div class="navLeft">
                    <div class="icon">üéØ</div>
                    <div class="navText"><div class="t">Objectives</div><div class="d">By sprint focus</div></div>
                </div>
                <span class="badge">3</span>
            </div>
            <div class="navItem" data-view="delivery">
                <div class="navLeft">
                    <div class="icon">üé´</div>
                    <div class="navText"><div class="t">Delivery</div><div class="d">Tickets + status</div></div>
                </div>
                <span class="badge">9</span>
            </div>
            <div class="navItem" data-view="reconcile">
                <div class="navLeft">
                    <div class="icon">üß©</div>
                    <div class="navText"><div class="t">Reconcile</div><div class="d">Smartsheet ‚Üî Tickets</div></div>
                </div>
                <span class="badge" id="reconBadge">4</span>
            </div>

            <div class="sectionTitle">Actions</div>
            <button class="btn primary" id="uploadBtn">Ôºã Upload docs/images</button>
            <button class="btn" id="runThreading">Run Threading Agent</button>
            <button class="btn" id="runRecon">Run Reconciliation Agent</button>
            <div style="margin-top:auto" class="hint">Example UI only. No external tools required.</div>
        </div>
    </aside>

    <!-- MIDDLE -->
    <main class="pane mid">
        <div class="bar">
            <div style="min-width:0">
                <div style="font-weight:900; font-size:14px;">Project Command Center</div>
                <div style="font-size:12px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
                    Chronological ingestion ‚Üí thread extraction ‚Üí sprint objectives ‚Üí delivery status ‚Üí plan reconciliation
                </div>
            </div>
            <span class="pill good">Cycle <b id="cycleLabel">Triaging</b></span>
            <div class="search">
                <span style="opacity:.8">‚åï</span>
                <input id="q" placeholder="Search uploads, threads, objectives, tickets‚Ä¶"/>
                <span class="kbd">/</span>
            </div>
            <button class="btn primary" id="newArtifact">Ôºã Artifact</button>
        </div>

        <div class="midBody">
            <!-- TODAY VIEW -->
            <section class="card view" id="view-today">
                <div class="cardHeader">
                    <div>
                        <div class="h">Today ‚Äî Attention Queue <span class="pill warn" style="padding:4px 8px;">needs review</span></div>
                        <div class="sub">Untriaged uploads, thread suggestions, objective drift, reconciliation conflicts.</div>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <button class="btn" id="quickStep">Step</button>
                        <button class="btn primary" id="quickPlay">Play</button>
                    </div>
                </div>
                <div class="cardBody">
                    <div class="grid2">
                        <div class="stream">
                            <div class="streamTop">
                                <div style="font-weight:800; font-size:12px;">Inbox Stream (latest)</div>
                                <span class="badge">12</span>
                            </div>
                            <div class="streamList" id="streamList"></div>
                        </div>

                        <div class="threadPane">
                            <div class="threadTabs">
                                <div class="tab active" data-tab="summary">Thread Summary</div>
                                <div class="tab" data-tab="actions">Actions</div>
                                <div class="tab" data-tab="decisions">Decisions</div>
                                <div class="tab" data-tab="evidence">Evidence</div>
                            </div>
                            <div class="threadBody" id="threadBody"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- OBJECTIVES VIEW -->
            <section class="card view" id="view-objectives" style="display:none;">
                <div class="cardHeader">
                    <div>
                        <div class="h">Objectives ‚Äî <span class="mono" id="objSprint">Sprint 13</span></div>
                        <div class="sub">Keep sprint focus explicit; link coverage to tickets and evidence.</div>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <button class="btn" id="addObj">Ôºã Objective</button>
                        <button class="btn primary" id="runObjAgent">Run Objective Agent</button>
                    </div>
                </div>
                <div class="cardBody">
                    <div class="objGrid" id="objGrid"></div>
                </div>
            </section>

            <!-- DELIVERY VIEW -->
            <section class="card view" id="view-delivery" style="display:none;">
                <div class="cardHeader">
                    <div>
                        <div class="h">Delivery ‚Äî Tickets & Status</div>
                        <div class="sub">Local ‚ÄúJira substitute‚Äù artifacts: initiative ‚Üí epic ‚Üí story ‚Üí subtask.</div>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <button class="btn" id="addTicket">Ôºã Ticket</button>
                        <button class="btn primary" id="genFromThread">Generate from Thread</button>
                    </div>
                </div>
                <div class="cardBody">
                    <div class="list" id="ticketList"></div>
                </div>
            </section>

            <!-- RECONCILE VIEW -->
            <section class="card view" id="view-reconcile" style="display:none;">
                <div class="cardHeader">
                    <div>
                        <div class="h">Reconcile ‚Äî Smartsheet ‚Üî Ticket Hierarchy</div>
                        <div class="sub">Agent proposes mappings; conflicts are categorized and actionable.</div>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <button class="btn" id="importSmart">Import Smartsheet CSV</button>
                        <button class="btn primary" id="applyRecon">Apply Reconcile</button>
                    </div>
                </div>
                <div class="cardBody">
                    <div class="reconGrid">
                        <div class="miniCol">
                            <div class="miniHead"><b>Smartsheet Rows</b><span class="badge">6</span></div>
                            <div class="miniBody" id="smartRows"></div>
                        </div>
                        <div class="miniCol">
                            <div class="miniHead"><b>Proposed Mapping</b><span class="badge" id="mapCount">4</span></div>
                            <div class="miniBody" id="mapping"></div>
                        </div>
                        <div class="miniCol">
                            <div class="miniHead"><b>Conflicts</b><span class="badge" id="confCount">4</span></div>
                            <div class="miniBody" id="conflicts"></div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- RIGHT -->
    <aside class="pane right">
        <div class="bar">
            <div class="brand" style="gap:10px;">
                <div style="font-weight:900;">Inspector</div>
                <span class="pill" id="insType">Selected <b>Upload</b></span>
            </div>
            <button class="btn" id="export">Export</button>
        </div>

        <div class="rightBody">
            <section class="card">
                <div class="cardHeader">
                    <div>
                        <div class="h">Threading Agent <span class="pill good" style="padding:4px 8px;">date-aware</span></div>
                        <div class="sub">Uses timestamps + entities + intent to form ‚Äúthreads.‚Äù</div>
                    </div>
                    <button class="btn primary" id="runThreading2">Run</button>
                </div>
                <div class="insBlock" id="threadingBlock"></div>
            </section>

            <section class="card">
                <div class="cardHeader">
                    <div>
                        <div class="h">Artifact Store</div>
                        <div class="sub">Fallback when Jira/Confluence/Smartsheet tools are unavailable.</div>
                    </div>
                    <button class="btn" id="attach">Attach</button>
                </div>
                <div class="insBlock">
                    <label>Artifact note (local)</label>
                    <textarea id="artifactNote">Attach evidence, decisions, and status updates here. Example: "PM says Phase 1 end date moved to Mar 20. We need ticket realignment."</textarea>
                    <div style="display:flex; gap:8px; margin-top:10px;">
                        <button class="btn primary" id="saveNote">Save</button>
                        <button class="btn" id="createTicketArtifact">Create Ticket Artifact</button>
                    </div>
                </div>
            </section>

            <section class="card">
                <div class="cardHeader">
                    <div>
                        <div class="h">Execution Log</div>
                        <div class="sub">Evidence of agent work + diffs + decisions.</div>
                    </div>
                </div>
                <div class="insBlock">
                    <div class="log" id="log"></div>
                </div>
            </section>
        </div>
    </aside>
</div>

<div class="toast" id="toast"><div class="ticon">‚úì</div><div id="toastText">Saved</div></div>

<script>
    // ----------------------------
    // Example data (what "working" looks like)
    // ----------------------------
    const state = {
      view: "today",
      selectedUploadId: "u1",
      selectedThreadId: "t1",
      tab: "summary"
    };

    const uploads = [
      {
        id:"u1",
        when:"2026-02-18 10:12",
        src:"Photo (whiteboard)",
        title:"State vs stateless split + durable retries",
        desc:"Sketch of KYC-SVC facade, tool annotations, evidence store, a2a retry semantics.",
        tags:["decision","thread:t1","risk"],
        suggestedThreads:[
          {id:"t1", title:"KYC-SVC Facade & Tooling", conf:0.86, why:"Mentions KYC-SVC + tool annotations; matches Feb 17 discussion."},
          {id:"t3", title:"Durability / Retries / Replay", conf:0.62, why:"Has retry / DLQ / replay notes; overlaps prior durability thread."}
        ],
        extractedActions:[
          "Create initiative: KYC-SVC Facade",
          "Define event model: idempotency + replay",
          "Draft ticket templates with DoR/DoD + NFRs"
        ]
      },
      {
        id:"u2",
        when:"2026-02-18 08:55",
        src:"Meeting Notes (paste)",
        title:"PM Smartsheet dates diverging from ticket reality",
        desc:"PM plan shows Phase 1 ends Mar 12; delivery tickets imply Mar 20. Need reconcile + mapping.",
        tags:["thread:t2","action"],
        suggestedThreads:[
          {id:"t2", title:"Plan Reconciliation (Smartsheet ‚Üî Tickets)", conf:0.91, why:"Explicit Smartsheet vs ticket mismatch."}
        ],
        extractedActions:[
          "Import Smartsheet rows",
          "Map rows ‚Üí epics/stories",
          "Generate conflicts report for PM"
        ]
      },
      {
        id:"u3",
        when:"2026-02-17 16:40",
        src:"Screenshot (diagram)",
        title:"Agentic assembly line planning flow",
        desc:"Ingest ‚Üí thread ‚Üí objectives by sprint ‚Üí tickets ‚Üí reconcile ‚Üí publish status.",
        tags:["thread:t4","decision"],
        suggestedThreads:[
          {id:"t4", title:"Agentic Project Planning Platform", conf:0.93, why:"End-to-end flow diagram."}
        ],
        extractedActions:[
          "Define objectives UI by sprint",
          "Define artifacts store (local Jira/Confluence)",
          "Define threading agent rubric"
        ]
      }
    ];

    const threads = [
      {
        id:"t1",
        title:"KYC-SVC Facade & Tooling",
        range:"Feb 17‚ÄìFeb 18",
        summary:"Goal: central fa√ßade service (KYC-SVC) to house transformations/safety/enrichment and expose tools to agents. Risks: overloading fa√ßade; unclear DoD; durability semantics for tool runs.",
        decisions:[
          "Facade will host tool annotations to reduce service footprint (vs separate MCP service).",
          "All tool runs must emit evidence IDs, persisted for traceability."
        ],
        actions:[
          {prio:"P1", title:"Define tool evidence schema", desc:"Evidence ID, inputs, outputs, policy checks, timestamps, links to artifacts."},
          {prio:"P1", title:"Ticket rubric template", desc:"DoR/DoD, AC, NFRs, observability hooks, rollout plan."},
          {prio:"P2", title:"Event-driven durability choice", desc:"EventBridge vs Kafka; replay, DLQ, idempotency."}
        ],
        evidence:["u1","u3"]
      },
      {
        id:"t2",
        title:"Plan Reconciliation (Smartsheet ‚Üî Tickets)",
        range:"Feb 18",
        summary:"PM‚Äôs Smartsheet plan not aligned with ticket hierarchy. Need automated mapping to initiative/epic/story/subtask and conflict categorization.",
        decisions:[
          "Reconcile view will be a first-class screen with diff + apply actions."
        ],
        actions:[
          {prio:"P1", title:"Import Smartsheet CSV", desc:"Local ingest when no tool access; normalize dates/owners."},
          {prio:"P1", title:"Generate mapping proposal", desc:"Row ‚Üí epic/story mapping with confidence + mismatch types."},
          {prio:"P2", title:"Produce PM delta pack", desc:"CSV/JSON output to share with PM for corrections."}
        ],
        evidence:["u2"]
      }
    ];

    const objectivesBySprint = {
      "Sprint 13": [
        { obj:"Objective A ‚Äî Stabilize Delivery Truth", kr:"KR: 90% tickets have owner/status updated in last 7 days; 0 unowned P1s.", coverage:72 },
        { obj:"Objective B ‚Äî Define Durability Semantics", kr:"KR: publish retry/replay spec; tool evidence schema live.", coverage:55 },
        { obj:"Objective C ‚Äî Reconcile PM Plan", kr:"KR: Smartsheet rows mapped to epics/stories with <10% unresolved conflicts.", coverage:41 }
      ]
    };

    const tickets = [
      { prio:"P1", title:"Initiative: KYC-SVC Facade", desc:"Create fa√ßade service; expose agent tools; define boundaries.", owner:"Eng Pod A", status:"In Progress", updated:"Feb 18" },
      { prio:"P1", title:"Epic: Evidence schema for tool runs", desc:"Evidence ID, storage, linkage to decisions/tickets.", owner:"Tooling", status:"Ready", updated:"Feb 18" },
      { prio:"P2", title:"Story: Ticket DoR/DoD rubric", desc:"Templates + scoring; improves ticket quality + predictability.", owner:"PMO", status:"Draft", updated:"Feb 17" },
      { prio:"P1", title:"Epic: Smartsheet ‚Üî ticket reconcile view", desc:"Diff screen, mapping, conflicts, apply actions.", owner:"Architect", status:"Blocked", updated:"Feb 18" }
    ];

    const smartsheetRows = [
      { id:"S-101", title:"Phase 1: Target Architecture complete", meta:"Owner: PMO ‚Ä¢ End: 2026-03-12" },
      { id:"S-102", title:"KYC-SVC fa√ßade MVP", meta:"Owner: Eng Pod A ‚Ä¢ End: 2026-03-18" },
      { id:"S-103", title:"Durability semantics spec", meta:"Owner: Architect ‚Ä¢ End: 2026-03-05" },
      { id:"S-104", title:"Observability baseline", meta:"Owner: SRE ‚Ä¢ End: 2026-03-25" }
    ];

    const proposedMapping = [
      { row:"S-101", mapsTo:"Initiative: Target Architecture", conf:"high", note:"Matches Phase 1 definition; missing exit criteria tickets." },
      { row:"S-102", mapsTo:"Initiative: KYC-SVC Facade", conf:"high", note:"Direct match; dates close." },
      { row:"S-103", mapsTo:"Epic: Durability Semantics Spec", conf:"med", note:"Ticket exists but scope split across 2 epics." },
      { row:"S-104", mapsTo:"Epic: Observability Baseline", conf:"med", note:"Ticket exists; owner mismatch (PM says SRE, tickets say Eng Pod A)." }
    ];

    const conflicts = [
      { type:"Date drift", detail:"Phase 1 end: Smartsheet Mar 12 vs tickets imply Mar 20", severity:"med" },
      { type:"Owner mismatch", detail:"Observability baseline owned by Eng Pod A in tickets; SRE in Smartsheet", severity:"med" },
      { type:"Missing ticket", detail:"Smartsheet row mentions 'exit criteria checklist' but no ticket exists", severity:"high" },
      { type:"Scope mismatch", detail:"Durability spec split across multiple epics; Smartsheet expects single row", severity:"low" }
    ];

    // ----------------------------
    // Helpers
    // ----------------------------
    const $ = (s)=>document.querySelector(s);
    const $$ = (s)=>Array.from(document.querySelectorAll(s));
    function toast(msg){
      $("#toastText").textContent = msg;
      $("#toast").classList.add("show");
      clearTimeout(toast._t);
      toast._t = setTimeout(()=>$("#toast").classList.remove("show"), 1500);
    }
    function log(msg){
      const stamp = new Date().toLocaleTimeString([], {hour:"2-digit", minute:"2-digit", second:"2-digit"});
      $("#log").textContent += `[${stamp}] ${msg}\n`;
      $("#log").scrollTop = $("#log").scrollHeight;
    }

    // ----------------------------
    // Render
    // ----------------------------
    function renderNav(){
      $$(".navItem[data-view]").forEach(n=>{
        n.classList.toggle("active", n.dataset.view === state.view);
      });
    }

    function renderStream(){
      const el = $("#streamList");
      el.innerHTML = "";
      uploads.forEach(u=>{
        const div = document.createElement("div");
        div.className = "streamItem" + (u.id===state.selectedUploadId ? " active":"");
        div.onclick = ()=>{ state.selectedUploadId=u.id; renderAll(); toast("Selected upload"); };
        div.innerHTML = `
          <div class="metaRow">
            <div class="when">${u.when}</div>
            <div class="src">${u.src}</div>
          </div>
          <div class="title">${u.title}</div>
          <div class="desc">${u.desc}</div>
          <div class="chips">
            ${u.tags.map(t=>{
              const cls = t.includes("thread:") ? "thread" : (t==="risk"?"risk":(t==="decision"?"decision":"action"));
              return `<span class="chip ${cls}">${t}</span>`;
            }).join("")}
          </div>
        `;
        el.appendChild(div);
      });
    }

    function currentUpload(){ return uploads.find(u=>u.id===state.selectedUploadId) || uploads[0]; }
    function currentThread(){
      const u = currentUpload();
      const tid = (u.suggestedThreads?.[0]?.id) || state.selectedThreadId;
      return threads.find(t=>t.id===tid) || threads[0];
    }

    function renderThreadPane(){
      const body = $("#threadBody");
      const tab = state.tab;
      const t = currentThread();
      state.selectedThreadId = t.id;

      if(tab==="summary"){
        body.innerHTML = `
          <div class="kv">
            <div class="k">Thread</div><div class="v"><b>${t.title}</b><div style="color:var(--muted); margin-top:4px;">Active range: ${t.range}</div></div>
            <div class="k">Summary</div><div class="v">${t.summary}</div>
            <div class="k">Linked evidence</div><div class="v">${t.evidence.map(id=>`<span class="chip thread">${id}</span>`).join(" ")}</div>
          </div>
          <div class="hint">From here you‚Äôd: generate tickets, link to sprint objectives, and store decisions with evidence IDs.</div>
        `;
      } else if(tab==="actions"){
        body.innerHTML = `
          <div class="list">
            ${t.actions.map(a=>`
              <div class="listItem">
                <div>
                  <div class="liTitle">${a.title}</div>
                  <div class="liDesc">${a.desc}</div>
                </div>
                <div class="liRight">
                  <span class="prio ${a.prio.toLowerCase()}">${a.prio}</span>
                  <button class="btn" style="padding:6px 8px;" onclick="(function(){window.__createTicket('${a.title}')})()">Create Ticket</button>
                </div>
              </div>
            `).join("")}
          </div>
        `;
      } else if(tab==="decisions"){
        body.innerHTML = `
          <div class="list">
            ${t.decisions.map(d=>`
              <div class="rowCard">
                <div class="rTitle">Decision</div>
                <div class="desc" style="margin-top:6px;">${d}</div>
                <div class="chips" style="margin-top:10px;">
                  <span class="chip decision">requires evidence link</span>
                  <span class="chip">approval: pending</span>
                </div>
              </div>
            `).join("")}
          </div>
        `;
      } else { // evidence
        body.innerHTML = `
          <div class="list">
            ${t.evidence.map(eid=>{
              const u = uploads.find(x=>x.id===eid);
              return `
                <div class="rowCard">
                  <div class="rTitle">${eid} ‚Äî ${u ? u.title : "Upload"}</div>
                  <div class="rMeta">${u ? u.when : ""} ‚Ä¢ ${u ? u.src : ""}</div>
                  <div class="desc" style="margin-top:6px;">${u ? u.desc : ""}</div>
                </div>
              `;
            }).join("")}
          </div>
        `;
      }
    }

    function renderThreadingInspector(){
      const u = currentUpload();
      $("#insType").innerHTML = `Selected <b>Upload</b>`;
      $("#threadingBlock").innerHTML = `
        <div class="kv">
          <div class="k">Selected upload</div>
          <div class="v"><b>${u.title}</b><div style="color:var(--muted); margin-top:4px;">${u.when} ‚Ä¢ ${u.src}</div></div>

          <div class="k">Suggested threads</div>
          <div class="v">
            ${u.suggestedThreads.map(s=>`
              <div style="display:flex; justify-content:space-between; gap:10px; align-items:center; margin-bottom:8px;">
                <div style="min-width:0;">
                  <div style="font-weight:800; font-size:12px;">${s.title}</div>
                  <div style="font-size:12px; color:var(--muted); margin-top:4px;">${s.why}</div>
                </div>
                <span class="badge">${Math.round(s.conf*100)}%</span>
              </div>
            `).join("")}
            <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;">
              <button class="btn primary" onclick="window.__promote()">Promote to Thread</button>
              <button class="btn" onclick="window.__linkObj()">Link to Objective</button>
              <button class="btn" onclick="window.__extract()">Extract Actions</button>
            </div>
          </div>

          <div class="k">Extracted actions</div>
          <div class="v">${u.extractedActions.map(a=>`<div class="desc" style="margin-bottom:6px;">‚Ä¢ ${a}</div>`).join("")}</div>
        </div>
      `;
    }

    function renderObjectives(){
      $("#objSprint").textContent = $("#sprintFilter").value;
      const list = objectivesBySprint[$("#sprintFilter").value] || objectivesBySprint["Sprint 13"];
      const el = $("#objGrid");
      el.innerHTML = "";
      list.forEach(o=>{
        const div = document.createElement("div");
        div.className = "objCard";
        div.innerHTML = `
          <div class="o">${o.obj}</div>
          <div class="kr">${o.kr}</div>
          <div class="cov">
            <div class="barOuter"><div class="barInner" style="width:${o.coverage}%"></div></div>
            <div class="pct">${o.coverage}%</div>
          </div>
          <div class="chips" style="margin-top:10px;">
            <span class="chip">tickets linked</span>
            <span class="chip ${o.coverage<50?'risk':''}">${o.coverage<50?'at risk':'ok'}</span>
          </div>
        `;
        el.appendChild(div);
      });
    }

    function renderTickets(){
      const el = $("#ticketList");
      el.innerHTML = "";
      tickets.forEach(t=>{
        const div = document.createElement("div");
        div.className="listItem";
        div.innerHTML = `
          <div>
            <div class="liTitle">${t.title}</div>
            <div class="liDesc">${t.desc}</div>
            <div class="chips">
              <span class="chip">owner: ${t.owner}</span>
              <span class="chip">updated: <span class="mono">${t.updated}</span></span>
            </div>
          </div>
          <div class="liRight">
            <span class="prio ${t.prio.toLowerCase()}">${t.prio}</span>
            <span class="badge">${t.status}</span>
            <button class="btn" style="padding:6px 8px;" onclick="window.__openRecon()">Diff vs PM plan</button>
          </div>
        `;
        el.appendChild(div);
      });
    }

    function renderReconcile(){
      const sEl = $("#smartRows");
      sEl.innerHTML = "";
      smartsheetRows.forEach(r=>{
        const div = document.createElement("div");
        div.className="rowCard";
        div.innerHTML = `<div class="rTitle">${r.id} ‚Äî ${r.title}</div><div class="rMeta">${r.meta}</div>`;
        sEl.appendChild(div);
      });

      const mEl = $("#mapping");
      mEl.innerHTML = "";
      proposedMapping.forEach(m=>{
        const div = document.createElement("div");
        div.className="rowCard";
        div.innerHTML = `
          <div style="display:flex; justify-content:space-between; gap:10px;">
            <div>
              <div class="rTitle">${m.row} ‚Üí ${m.mapsTo}</div>
              <div class="desc" style="margin-top:6px;">${m.note}</div>
            </div>
            <span class="conf ${m.conf}">${m.conf.toUpperCase()}</span>
          </div>
        `;
        mEl.appendChild(div);
      });
      $("#mapCount").textContent = proposedMapping.length;

      const cEl = $("#conflicts");
      cEl.innerHTML = "";
      conflicts.forEach(c=>{
        const div = document.createElement("div");
        div.className="rowCard";
        div.innerHTML = `
          <div style="display:flex; justify-content:space-between; gap:10px; align-items:flex-start;">
            <div>
              <div class="rTitle">${c.type}</div>
              <div class="desc" style="margin-top:6px;">${c.detail}</div>
            </div>
            <span class="conf ${c.severity==='high'?'high':(c.severity==='med'?'med':'low')}">${c.severity.toUpperCase()}</span>
          </div>
        `;
        cEl.appendChild(div);
      });
      $("#confCount").textContent = conflicts.length;
    }

    function showView(v){
      state.view = v;
      renderNav();
      $$(".view").forEach(x=>x.style.display="none");
      $("#view-"+v).style.display = "";
      toast("View: "+v);
    }

    function renderTabs(){
      $$(".tab").forEach(t=>t.classList.toggle("active", t.dataset.tab===state.tab));
    }

    function renderAll(){
      renderNav();
      renderStream();
      renderThreadingInspector();
      renderTabs();
      renderThreadPane();
      renderObjectives();
      renderTickets();
      renderReconcile();
    }

    // ----------------------------
    // Wire events
    // ----------------------------
    $$(".navItem[data-view]").forEach(n=>n.addEventListener("click", ()=>showView(n.dataset.view)));

    $$(".tab").forEach(t=>t.addEventListener("click", ()=>{
      state.tab = t.dataset.tab;
      renderAll();
    }));

    $("#sprintFilter").addEventListener("change", ()=>{
      $("#cycleLabel").textContent = "Sprint Focus";
      renderObjectives();
      toast("Sprint changed");
    });

    $("#q").addEventListener("input", (e)=>{
      const q = e.target.value.trim().toLowerCase();
      if(!q){ renderStream(); return; }
      // quick filter stream for demo
      const el = $("#streamList");
      el.innerHTML = "";
      uploads.filter(u => (u.title+" "+u.desc+" "+u.tags.join(" ")).toLowerCase().includes(q))
        .forEach(u=>{
          const div = document.createElement("div");
          div.className = "streamItem";
          div.onclick = ()=>{ state.selectedUploadId=u.id; renderAll(); };
          div.innerHTML = `
            <div class="metaRow"><div class="when">${u.when}</div><div class="src">${u.src}</div></div>
            <div class="title">${u.title}</div>
            <div class="desc">${u.desc}</div>
          `;
          el.appendChild(div);
        });
    });

    // keyboard shortcut
    window.addEventListener("keydown", (e)=>{
      if(e.key === "/" && document.activeElement !== $("#q")){
        e.preventDefault(); $("#q").focus();
      }
    });

    // Buttons
    $("#uploadBtn").addEventListener("click", ()=>{ log("UPLOAD: Added new upload (mock). Threading Agent queued."); toast("Uploaded (mock)"); });
    $("#runThreading").addEventListener("click", ()=>{ log("THREADING: clustered last 24h uploads into 2 threads; 1 needs review."); $("#cycleLabel").textContent="Threading"; toast("Threading complete"); });
    $("#runThreading2").addEventListener("click", ()=>{ log("THREADING: reran on selected upload; updated confidence + suggested actions."); toast("Reran threading"); });
    $("#runRecon").addEventListener("click", ()=>{ showView("reconcile"); log("RECON: generated mapping proposal + conflicts report."); $("#cycleLabel").textContent="Reconciling"; toast("Reconcile complete"); });
    $("#runObjAgent").addEventListener("click", ()=>{ log("OBJECTIVES: detected drift; 2 tickets not linked to sprint objectives."); toast("Objective agent ran"); });
    $("#addTicket").addEventListener("click", ()=>{ tickets.unshift({prio:"P2", title:"Story: (new) from UI", desc:"Add scope/AC/NFRs/deps/rollout.", owner:"Eng Pod A", status:"Draft", updated:"Feb 18"}); renderTickets(); toast("Ticket added"); });
    $("#genFromThread").addEventListener("click", ()=>{ log("TICKETING: generated 6 stories + 14 subtasks from selected thread; pending review."); toast("Generated (mock)"); });
    $("#importSmart").addEventListener("click", ()=>{ log("SMARTSHEET: imported CSV (mock). Normalized owners and dates."); toast("Imported (mock)"); });
    $("#applyRecon").addEventListener("click", ()=>{ log("RECON APPLY: created missing tickets + updated owners/dates; produced delta pack for PM."); toast("Applied (mock)"); });
    $("#saveNote").addEventListener("click", ()=>{ log("ARTIFACT: saved local note and linked to selected upload/thread."); toast("Saved"); });
    $("#createTicketArtifact").addEventListener("click", ()=>{ log("ARTIFACT‚ÜíTICKET: created local ticket artifact from note (mock)."); toast("Created ticket artifact"); });
    $("#newArtifact").addEventListener("click", ()=>{ log("ARTIFACT: created placeholder doc `decision_record.md` (mock)."); toast("New artifact"); });
    $("#export").addEventListener("click", ()=>{
      const dump = { view: state.view, selectedUpload: currentUpload(), selectedThread: currentThread(), sprint: $("#sprintFilter").value, tickets, conflicts };
      log("EXPORT:\n" + JSON.stringify(dump, null, 2));
      toast("Exported to log");
    });

    // Expose small callbacks for inline buttons
    window.__createTicket = (title)=>{
      tickets.unshift({ prio:"P1", title:"Story: "+title, desc:"Generated from thread action. Add AC/NFRs/DoD.", owner:"Eng Pod A", status:"Draft", updated:"Feb 18" });
      renderTickets();
      log("TICKETING: created ticket from action: "+title);
      toast("Ticket created");
    };
    window.__promote = ()=>{ log("THREAD: promoted upload to thread and linked evidence IDs."); toast("Promoted (mock)"); };
    window.__linkObj = ()=>{ showView("objectives"); log("OBJECTIVES: linked selected upload/thread to Sprint objective (mock)."); toast("Linked (mock)"); };
    window.__extract = ()=>{ log("ACTIONS: extracted actions from upload and pushed to thread action list."); toast("Extracted (mock)"); };
    window.__openRecon = ()=>{ showView("reconcile"); log("RECON: opened diff for selected ticket vs Smartsheet rows."); toast("Opened reconcile"); };

    // Init
    (function init(){
      // set default dates (example)
      const today = new Date();
      const pad = (n)=>String(n).padStart(2,"0");
      const iso = (d)=>`${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
      const from = new Date(today.getTime() - 7*86400000);
      $("#fromDate").value = iso(from);
      $("#toDate").value = iso(today);
      renderAll();
    })();
</script>
</body>
</html>
